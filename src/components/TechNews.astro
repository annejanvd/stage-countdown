---
---
<div class="flex flex-col items-center justify-center p-6 h-full w-full relative overflow-hidden">
    <span class="text-text-secondary uppercase tracking-wider text-xs font-medium mb-2 absolute top-4 left-6">
        Tech News
    </span>
    
    <div id="tech-news-container" class="w-full text-center relative h-20 flex flex-col items-center justify-center">
        <span id="tech-headline" class="text-text-primary text-lg font-medium leading-tight line-clamp-2 transition-opacity duration-500 opacity-100">
            Loading news...
        </span>
        <span id="tech-time" class="text-text-muted text-xs font-mono mt-2 transition-opacity duration-500 opacity-100">
            --:--
        </span>
    </div>

    <!-- Progress bar -->
    <div class="absolute bottom-0 left-0 h-1 bg-music-accent/30 w-full">
        <div id="tech-progress" class="h-full bg-music-accent w-0"></div>
    </div>
</div>

<script>
    let newsItems: {title: string, time: string}[] = [];
    let currentIndex = 0;

    async function fetchNews() {
        try {
            const res = await fetch('/api/technews');
            const data = await res.json();
            newsItems = data.headlines || [];
            if (newsItems.length > 0) {
                showHeadline(0);
            }
        } catch {}
    }

    function showHeadline(index: number) {
        const titleEl = document.getElementById('tech-headline');
        const timeEl = document.getElementById('tech-time');
        
        if (titleEl) {
            titleEl.style.opacity = '0';
            if(timeEl) timeEl.style.opacity = '0';

            setTimeout(() => {
                if (newsItems[index]) {
                    titleEl.textContent = newsItems[index].title;
                    if(timeEl) timeEl.textContent = newsItems[index].time;
                }
                titleEl.style.opacity = '1';
                if(timeEl) timeEl.style.opacity = '1';
            }, 500);
        }

        const bar = document.getElementById('tech-progress');
        if (bar) {
            bar.style.transition = 'none';
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.transition = 'width 60s linear';
                bar.style.width = '100%';
            }, 50);
        }
    }

    function rotate() {
        if (newsItems.length === 0) return;
        currentIndex = (currentIndex + 1) % newsItems.length;
        showHeadline(currentIndex);
    }

    fetchNews();
    setInterval(rotate, 60000);
</script>
